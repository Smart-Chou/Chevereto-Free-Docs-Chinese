import{r as c,o as l,c as i,a as n,b as a,w as o,F as r,e as t,d as s}from"./app.c1a8397c.js";import{_ as u}from"./plugin-vue_export-helper.21dcd24c.js";const d={},k=t('<h1 id="\u8981\u6C42" tabindex="-1"><a class="header-anchor" href="#\u8981\u6C42" aria-hidden="true">#</a> \u8981\u6C42</h1><h2 id="php" tabindex="-1"><a class="header-anchor" href="#php" aria-hidden="true">#</a> PHP</h2><table><thead><tr><th>\u7248\u672C</th><th>PHP</th></tr></thead><tbody><tr><td>3.20</td><td>7.4</td></tr></tbody></table>',3),b=s("Chevereto \u662F "),h={href:"https://php.net/",target:"_blank",rel:"noopener noreferrer"},m=s("PHP"),g=s(" \u8F6F\u4EF6\uFF0C\u5B83\u7684\u8BBE\u8BA1\u4F7F\u7528\uFF1A"),v={href:"https://deb.sury.org/",target:"_blank",rel:"noopener noreferrer"},_=s("PHP \u5305"),f=s(" \u6765\u81EA Ond\u0159ej Sur\xFD\u3002"),y={href:"https://www.php.net/manual/en/extensions.membership.php",target:"_blank",rel:"noopener noreferrer"},P=s("PHP \u6269\u5C55"),w=s(" \u7531 "),x={href:"https://pecl.php.net/",target:"_blank",rel:"noopener noreferrer"},q=s("PECL"),M=s(" \u63D0\u4F9B\u3002"),I=t(`<p>\u5305\u548C PECL \u63D0\u4F9B\u4E86\u76F8\u540C\u7684\u4FBF\u5229\uFF0C\u4F46\u7531\u4E8E\u5305\u662F\u4E3A\u57FA\u4E8E debian \u7684\u7CFB\u7EDF\u5236\u4F5C\u7684\uFF0C\u5982\u679C\u60A8\u6CA1\u6709\u517C\u5BB9\u7684\u7CFB\u7EDF\uFF0C\u60A8\u5E94\u8BE5\u66F4\u559C\u6B22 PECL\u3002</p><div class="custom-container warning"><p class="custom-container-title">Packages vs PECL</p><p>\u5305\u4E0D\u4EC5\u5305\u542B\u8F6F\u4EF6\uFF0C\u8FD8\u53EF\u4EE5\u89E6\u53D1\u7CFB\u7EDF\u4E2D\u7684\u5176\u4ED6\u6548\u679C\u3002</p></div><h3 id="php-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#php-\u914D\u7F6E" aria-hidden="true">#</a> PHP \u914D\u7F6E</h3><p>\u5BF9\u4E8E Chevereto \u5B89\u88C5\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u4EE5\u4E0B <code>ini</code> \u503C\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>upload_max_filesize <span class="token operator">=</span> 50M<span class="token punctuation">;</span>
post_max_size <span class="token operator">=</span> 50M<span class="token punctuation">;</span>
max_execution_time <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
memory_limit <span class="token operator">=</span> 512M<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><table><thead><tr><th>\u7269\u4E1A</th><th>\u8BF4\u660E</th><th>\u793A\u4F8B</th></tr></thead><tbody><tr><td>upload_max_filesize</td><td>\u6700\u5927\u4E0A\u4F20\u5927\u5C0F</td><td><code>50M</code> \u4E3A 50 MB</td></tr><tr><td>post_max_size</td><td>\u6700\u5927\u5E16\u5B50\u5927\u5C0F</td><td>\u540C\u4E0A</td></tr><tr><td>max_execution_time</td><td>\u6267\u884C\u8F6F\u4EF6\u7684\u6700\u957F\u65F6\u95F4\uFF0C\u4EE5\u79D2\u4E3A\u5355\u4F4D</td><td><code>30</code> 30 \u79D2</td></tr><tr><td>memory_limit</td><td>\u5206\u914D\u7684\u6700\u5927\u5185\u5B58</td><td><code>512M</code> \u4E3A 512 MB</td></tr></tbody></table>`,6),H=s("\u60A8\u53EF\u4EE5\u5207\u6362\u6B64\u9650\u5236\u4EE5\u53CD\u6620\u60A8\u7684\u786C\u4EF6\u548C\u670D\u52A1\u5668\u8D1F\u8F7D\u3002\u67E5\u770B\u8FD9\u7BC7\u6587\u7AE0\u4E86\u89E3\u66F4\u591A\u4FE1\u606F\uFF1A"),C={href:"http://www.php.net/manual/en/features.file-upload.common-pitfalls.php",target:"_blank",rel:"noopener noreferrer"},L=s("PHP \u5E38\u89C1\u9677\u9631"),F=s("\u3002"),$=t('<h3 id="php-\u6269\u5C55" tabindex="-1"><a class="header-anchor" href="#php-\u6269\u5C55" aria-hidden="true">#</a> PHP \u6269\u5C55</h3><p>Chevereto \u9700\u8981\u4EE5\u4E0B PHP \u6269\u5C55\u3002</p><ul><li>\u5377\u66F2</li><li>exif</li><li>\u6587\u4EF6\u4FE1\u606F</li><li>\u54C8\u5E0C</li><li>\u60F3\u8C61</li><li>gd</li><li>json</li><li>\u5B57\u7B26\u4E32</li><li>pdo</li><li>pdo-mysql</li><li>\u4F1A\u8BAE</li><li>xml</li><li>\u538B\u7F29</li></ul><h3 id="php-\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#php-\u529F\u80FD" aria-hidden="true">#</a> PHP \u529F\u80FD</h3><p>Chevereto \u9700\u8981\u4E0D\u53D7\u9650\u5236\u5730\u8BBF\u95EE\u6240\u6709 PHP \u51FD\u6570\u3002\u5982\u679C\u5220\u9664\u4EFB\u4F55 PHP \u51FD\u6570\uFF0C\u5B83\u53EF\u80FD\u4F1A\u5BFC\u81F4 Chevereto \u5931\u8D25\u6216\u6839\u672C\u65E0\u6CD5\u5DE5\u4F5C\u3002\u8BF7\u6CE8\u610F\uFF0C\u4E0D\u5F97\u9650\u5236\u4EE5\u4E0B\u529F\u80FD\uFF1A</p>',5),A={href:"https://www.php.net/set-time-limit",target:"_blank",rel:"noopener noreferrer"},D=s("set_time_limit"),G=n("h2",{id:"\u56FE\u7247\u5E93",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u56FE\u7247\u5E93","aria-hidden":"true"},"#"),s(" \u56FE\u7247\u5E93")],-1),R=n("p",null,[s("\u56FE\u50CF\u5E93(GD\u3001Imagick)\u5E94\u8BE5\u652F\u6301"),n("code",null,"PNG GIF JPG BMP WEBP"),s("\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CChevereto \u4F7F\u7528 Imagick \u5E76\u56DE\u9000\u5230 GD\u3002")],-1),B=s("\u5982\u679C\u60A8\u9700\u8981\u663E\u5F0F\u4F7F\u7528 GD\uFF0C\u60A8\u53EF\u4EE5\u5C06\u6B64\u952E\u6DFB\u52A0\u5230 "),E=s("\u8BBE\u7F6E\u6587\u4EF6"),N=s("\uFF1A"),S=t(`<div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$settings</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;image_library&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;gd&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div>`,1),O={class:"custom-container danger"},z=n("p",{class:"custom-container-title"},"\u89E3\u51B3\u65B9\u6CD5\u4E22\u5931\u683C\u5F0F",-1),T=s("\u5982\u679C\u670D\u52A1\u5668\u4E0D\u652F\u6301 Chevereto \u5904\u7406\u7684\u6240\u6709\u56FE\u50CF\u683C\u5F0F\uFF0C\u60A8\u5FC5\u987B\u4F7F\u7528\u4EE5\u4E0B "),V=s("\u8BBE\u7F6E\u6587\u4EF6"),j=s(" \u89E3\u51B3\u65B9\u6CD5\u3002"),W=t(`<p>\u5728\u4EE5\u4E0B\u793A\u4F8B\u4E2D\uFF0CChevereto \u914D\u7F6E\u4E3A\u4EC5\u663E\u5F0F\u652F\u6301 PNG\u3001GIF\u3001BMP \u548C JPG(\u5220\u9664 WEBP)\uFF1A</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$settings</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;image_formats_available&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;PNG&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;GIF&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;BMP&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;JPG&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div>`,2),J=n("h2",{id:"\u914D\u7F6E\u56FE\u7247\u5E93",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u914D\u7F6E\u56FE\u7247\u5E93","aria-hidden":"true"},"#"),s(" \u914D\u7F6E\u56FE\u7247\u5E93")],-1),K=s("\u68C0\u67E5 "),X=s("CHEVERETO_IMAGE_LIBRARY"),Q=s(" \u4EE5\u66F4\u6539 Chevereto \u4F7F\u7528\u7684\u9ED8\u8BA4\u56FE\u50CF\u5E93\u3002"),U=t(`<h3 id="imagemagick" tabindex="-1"><a class="header-anchor" href="#imagemagick" aria-hidden="true">#</a> ImageMagick</h3><p>\u5728 <code>/etc/ImageMagick-6/policy.xml</code> \u6587\u4EF6\u4E2D\u63A8\u8350\u7684\u5176\u4ED6 ImageMagick \u914D\u7F6E\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>policymap</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- policies --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>policy</span> <span class="token attr-name">domain</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>resource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16KP<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>policy</span> <span class="token attr-name">domain</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>resource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>height<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16KP<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>policymap</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="\u6587\u4EF6\u7CFB\u7EDF" tabindex="-1"><a class="header-anchor" href="#\u6587\u4EF6\u7CFB\u7EDF" aria-hidden="true">#</a> \u6587\u4EF6\u7CFB\u7EDF</h3><p>\u8FD0\u884C <code>php</code> \u7684\u7528\u6237\u5FC5\u987B\u5728\u4F60\u7684\u5B89\u88C5\u76EE\u5F55\u7684\u6240\u6709\u8005\u7EC4\u4E2D\u3002\u8FD9\u662F\u5141\u8BB8 Chevereto \u4FEE\u6539\u6587\u4EF6\u7CFB\u7EDF\u4EE5\u8FDB\u884C\u4E0A\u4F20\u3001\u4E00\u952E\u66F4\u65B0\u548C\u8BB8\u591A\u5176\u4ED6\u529F\u80FD\u6240\u5FC5\u9700\u7684\u3002</p><p>Chevereto \u7528\u6237\u9700\u8981\u5728\u4EE5\u4E0B\u8DEF\u5F84\u4E2D\u5177\u6709 <strong>\u8BFB/\u5199</strong> \u8BBF\u95EE\u6743\u9650\uFF1A</p><ul><li><code>/tmp</code></li><li><code>app/content/</code></li><li><code>app/content/languages/</code></li><li><code>app/content/languages/cache/</code></li><li><code>app/content/system/</code></li><li><code>content/</code></li><li><code>images/</code></li></ul><h2 id="\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u5E93" aria-hidden="true">#</a> \u6570\u636E\u5E93</h2><table><thead><tr><th>\u7248\u672C</th><th>MySQL</th><th>MariaDB</th></tr></thead><tbody><tr><td>3.20</td><td>5.7, 8</td><td>10</td></tr></tbody></table><ul><li>\u6570\u636E\u5E93\u7528\u6237\u5FC5\u987B\u5BF9\u76EE\u6807\u6570\u636E\u5E93\u62E5\u6709<code>ALL PRIVILEGES</code></li><li>InnoDB \u8868\u5B58\u50A8\u5F15\u64CE</li></ul>`,10),Y={class:"custom-container danger"},Z=n("p",{class:"custom-container-title"},"\u4ECE\u65E7\u5B89\u88C5\u5347\u7EA7",-1),nn=s("\u4F7F\u7528 MyISAM \u8868\u5B58\u50A8\u5F15\u64CE\u7684\u65E7\u7248\u672C\u5C06\u9700\u8981\u5C06\u65E7\u8868\u8F6C\u6362\u4E3A InnoDB\u3002\u9605\u8BFB"),sn={href:"https://dev.mysql.com/doc/refman/8.0/en/converting-tables-to-innodb.html",target:"_blank",rel:"noopener noreferrer"},an=s("\u5C06 MyISAM \u8868\u8F6C\u6362\u4E3A InnoDB"),en=n("h2",{id:"web-\u670D\u52A1\u5668\u914D\u7F6E",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#web-\u670D\u52A1\u5668\u914D\u7F6E","aria-hidden":"true"},"#"),s(" Web \u670D\u52A1\u5668\u914D\u7F6E")],-1),tn=n("h3",{id:"apache-http-\u670D\u52A1\u5668",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#apache-http-\u670D\u52A1\u5668","aria-hidden":"true"},"#"),s(" Apache HTTP \u670D\u52A1\u5668")],-1),pn=s("\u786E\u4FDD "),on={href:"https://httpd.apache.org/docs/current/mod/mod_rewrite.html",target:"_blank",rel:"noopener noreferrer"},cn=n("code",null,"mod_rewrite",-1),ln=s(" \u5DF2\u542F\u7528\uFF0C\u5E76\u4E14\u60A8\u7684\u865A\u62DF\u4E3B\u673A\u8BBE\u7F6E\u5141\u8BB8\u6267\u884C URL \u91CD\u5199\uFF1A"),rn=t(`<div class="language-apacheconf ext-apacheconf line-numbers-mode"><pre class="language-apacheconf"><code>    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>Directory</span><span class="token directive-block-parameter attr-value"> /var/www/html</span><span class="token punctuation">&gt;</span></span>
        <span class="token directive-inline property">Options</span> -Indexes +FollowSymLinks +MultiViews
        <span class="token directive-inline property">AllowOverride</span> All
        <span class="token directive-inline property">Require</span> all granted
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Apache \u914D\u7F6E<code>.htaccess</code> \u6587\u4EF6\u5DF2\u7ECF\u5305\u542B\u5728\u8F6F\u4EF6\u4E2D\u3002</p><h4 id="\u9650\u5236\u76F4\u63A5\u8BBF\u95EE-php-\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u9650\u5236\u76F4\u63A5\u8BBF\u95EE-php-\u6587\u4EF6" aria-hidden="true">#</a> \u9650\u5236\u76F4\u63A5\u8BBF\u95EE PHP \u6587\u4EF6</h4>`,3),un=s("\u901A\u8FC7\u4E3A\u60A8\u7684\u4E0A\u4F20\u76EE\u5F55\u6DFB\u52A0\u4EE5\u4E0B\u6307\u4EE4\u6765\u7F16\u8F91 "),dn={href:"https://httpd.apache.org/docs/2.4/vhosts/",target:"_blank",rel:"noopener noreferrer"},kn=s("Virtual Host"),bn=s(" \u6761\u76EE\u3002\u8FD9\u5C06\u5728\u5305\u542B\u516C\u5171\u4E0A\u4F20\u5185\u5BB9\u7684\u6587\u4EF6\u5939\u4E0A\u7981\u7528 PHP \u89E3\u91CA\u5668\uFF1A"),hn=t(`<blockquote><p>\u5FC5\u987B\u7F16\u8F91 <code>/var/www/html/images</code> \u4EE5\u53CD\u6620\u60A8\u7684\u5B9E\u9645\u4E0A\u4F20\u76EE\u5F55\u3002</p></blockquote><div class="language-apacheconf ext-apacheconf line-numbers-mode"><pre class="language-apacheconf"><code><span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>Directory</span><span class="token directive-block-parameter attr-value"> /var/www/html/images</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-inline property">AllowOverride</span> None
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>FilesMatch</span><span class="token directive-block-parameter attr-value"> &quot;\\.(?<span class="token punctuation">:</span>[Pp][Hh][Pp][345]?|[Pp][Hh][Tt][Mm][Ll])|(po|sql|html?)$&quot;</span><span class="token punctuation">&gt;</span></span>
        <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> !mod_authz_core.c</span><span class="token punctuation">&gt;</span></span>
            <span class="token directive-inline property">Order</span> <span class="token directive-inline property">Allow</span>,Deny
            <span class="token directive-inline property">Deny</span> from all
        <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
        <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> mod_authz_core.c</span><span class="token punctuation">&gt;</span></span>
            <span class="token directive-inline property">Require</span> all denied
        <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> mod_php7.c</span><span class="token punctuation">&gt;</span></span>
        php_flag engine off
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>FilesMatch</span><span class="token directive-block-parameter attr-value"> <span class="token string">&quot;.+\\.*$&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token directive-inline property">SetHandler</span> !
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> mod_rewrite.c</span><span class="token punctuation">&gt;</span></span>
        <span class="token directive-inline property">RewriteRule</span><span class="token regex"> ^.*\\.php$</span> - <span class="token directive-flags keyword">[F,L]</span>
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>\u5982\u679C\u60A8\u65E0\u6743\u7F16\u8F91 Apache \u865A\u62DF\u4E3B\u673A\uFF0C\u5219\u53EF\u4EE5\u5728\u6240\u8C13\u7684\u8DEF\u5F84\u4E2D\u4F7F\u7528 <code>.htaccess</code> \u6587\u4EF6\uFF1A</p><div class="language-apacheconf ext-apacheconf line-numbers-mode"><pre class="language-apacheconf"><code><span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>FilesMatch</span><span class="token directive-block-parameter attr-value"> &quot;\\.(?<span class="token punctuation">:</span>[Pp][Hh][Pp][345]?|[Pp][Hh][Tt][Mm][Ll])|(po|sql|html?)$&quot;</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> !mod_authz_core.c</span><span class="token punctuation">&gt;</span></span>
        <span class="token directive-inline property">Order</span> <span class="token directive-inline property">Allow</span>,Deny
        <span class="token directive-inline property">Deny</span> from all
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> mod_authz_core.c</span><span class="token punctuation">&gt;</span></span>
        <span class="token directive-inline property">Require</span> all denied
    <span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> mod_php7.c</span><span class="token punctuation">&gt;</span></span>
    php_flag engine off
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>FilesMatch</span><span class="token directive-block-parameter attr-value"> <span class="token string">&quot;.+\\.*$&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-inline property">SetHandler</span> !
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">&gt;</span></span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;</span>IfModule</span><span class="token directive-block-parameter attr-value"> mod_rewrite.c</span><span class="token punctuation">&gt;</span></span>
    <span class="token directive-inline property">RewriteRule</span><span class="token regex"> ^.*\\.php$</span> - <span class="token directive-flags keyword">[F,L]</span>
<span class="token directive-block tag"><span class="token directive-block tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx" aria-hidden="true">#</a> NGINX</h3><p><code>server {}</code> \u5757\u7684 <code>nginx.conf</code>\uFF1A</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code>    <span class="token comment"># Disable access to sensitive application files</span>
    <span class="token directive"><span class="token keyword">location</span> ~* (app|content|lib)/.*\\.(po|php|lock|sql)$</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">return</span> <span class="token number">404</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">location</span> ~* composer\\.json|composer\\.lock|.gitignore$</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">return</span> <span class="token number">404</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">location</span> ~* /\\.ht</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">return</span> <span class="token number">404</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># Image not found replacement</span>
    <span class="token directive"><span class="token keyword">location</span> ~* \\.(jpe?g|png|gif|webp)$</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">log_not_found</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">error_page</span> <span class="token number">404</span> /content/images/system/default/404.gif</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># CORS header (avoids font rendering issues)</span>
    <span class="token directive"><span class="token keyword">location</span> ~* \\.(ttf|ttc|otf|eot|woff|woff2|font.css|css|js)$</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">add_header</span> Access-Control-Allow-Origin <span class="token string">&quot;*&quot;</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># PHP front controller</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">index</span> index.php</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.php<span class="token variable">$is_args</span><span class="token variable">$query_string</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment"># Single PHP-entrypoint (disables direct access to .php files)</span>
    <span class="token directive"><span class="token keyword">location</span> ~* \\.php$</span>  <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">internal</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">include</span> snippets/fastcgi-php.conf</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">fastcgi_pass</span> unix:/var/run/php/php7.4-fpm.sock</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h3 id="\u771F\u5B9E\u8FDE\u63A5ip" tabindex="-1"><a class="header-anchor" href="#\u771F\u5B9E\u8FDE\u63A5ip" aria-hidden="true">#</a> \u771F\u5B9E\u8FDE\u63A5IP</h3>`,8),mn=s("\u5BF9\u4E8E\u4EFB\u4F55\u7C7B\u578B\u7684\u4EE3\u7406(\u5305\u62EC "),gn={href:"https://support.cloudflare.com/hc/en-us/articles/200170786-Restoring-original-visitor-IPs",target:"_blank",rel:"noopener noreferrer"},vn=s("CloudFlare"),_n=s(")\u4E0B\u7684\u8BBE\u7F6E\uFF0CWeb \u670D\u52A1\u5668\u9700\u8981\u8BBE\u7F6E\u5BA2\u6237\u7AEF\u8FDE\u63A5 IP \u7684\u9002\u5F53\u503C\u3002"),fn=n("div",{class:"custom-container danger"},[n("p",{class:"custom-container-title"},"\u8B66\u544A"),n("p",null,"\u5982\u679C\u672A\u914D\u7F6E\u771F\u5B9E\u8FDE\u63A5 IP\uFF0CChevereto \u5C06\u65E0\u6CD5\u68C0\u6D4B\u771F\u5B9E\u8BBF\u95EE\u8005 IP\uFF0C\u65E0\u6CD5\u63D0\u4F9B\u57FA\u4E8E IP \u7684\u9650\u5236\u548C\u6D2A\u6C34\u63A7\u5236\u3002")],-1),yn=n("ul",null,[n("li",null,[s("NGINX\uFF1A"),n("code",null,"ngx_http_realip_module")]),n("li",null,[s("Apache HTTP \u670D\u52A1\u5668\uFF1A"),n("code",null,"mod_remoteip")])],-1);function Pn(wn,xn){const e=c("ExternalLinkIcon"),p=c("RouterLink");return l(),i(r,null,[k,n("p",null,[b,n("a",h,[m,a(e)]),g]),n("ul",null,[n("li",null,[n("a",v,[_,a(e)]),f]),n("li",null,[n("a",y,[P,a(e)]),w,n("a",x,[q,a(e)]),M])]),I,n("p",null,[H,n("a",C,[L,a(e)]),F]),$,n("ul",null,[n("li",null,[n("a",A,[D,a(e)])])]),G,R,n("p",null,[B,a(p,{to:"/setup/server/settings-file.html"},{default:o(()=>[E]),_:1}),N]),S,n("div",O,[z,n("p",null,[T,a(p,{to:"/setup/server/settings-file.html"},{default:o(()=>[V]),_:1}),j]),W]),J,n("p",null,[K,a(p,{to:"/setup/server/environment.html#image-handling-variables"},{default:o(()=>[X]),_:1}),Q]),U,n("div",Y,[Z,n("p",null,[nn,n("a",sn,[an,a(e)])])]),en,tn,n("p",null,[pn,n("a",on,[cn,a(e)]),ln]),rn,n("p",null,[un,n("a",dn,[kn,a(e)]),bn]),hn,n("p",null,[mn,n("a",gn,[vn,a(e)]),_n]),fn,yn],64)}var In=u(d,[["render",Pn]]);export{In as default};
